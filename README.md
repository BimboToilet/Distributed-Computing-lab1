# Лабораторная работа по Pthreads
## Задание №1
Задача заключается в определении числа π по методу Монте-Карло.
  
В квадрат со стороной 2*r случайным образом бросается какой-нибудь предмет, внутри этого квадрата есть вписанная окружность с радиусом r. 
Отношение попаданий в эту окружность к общему числу бросков равно π/4.
  
На вход программе подается количество потоков и общее количество попыток.
Алгоритм заключается в создании указанного числа потоков, создании массива, в который каждый поток запишет результат своих вычислений. Каждый поток делает количество «бросков», равное общему количество попыток, деленному на количество потоков (для удобства мы предполагаем, что указанное общее количество попыток делится нацело на число потоков). 
  
Затем главный поток суммирует значения из массива ответов и на их основе вычисляет число π.
## Задание №3
Задача заключается в создании своей реализацию типа 'rwlock' и функций 'rdlock', 'wrlock'.
  
Созданная структура состоит из непосредственно самого мьютекса, из условных переменных для читателей и писателей (чтобы будить их при возможности заблокировать мьютекс), счетчика читателей, счетчиков ожидающих читателей и писателей, а также булевой переменной, которая сообщает, активен ли сейчас какой-нибудь писатель.
  
Так же написаны функции инициализации и уничтожения этой структуры, которые инициализируют и уничтожают мьютексы и условные переменные внутри структуры.
  
Функция 'rwlock_rdlock' блокирует на чтение, при вызове она блокирует внутренний мьютекс и увеличивает число ожидающих читателей, далее, если никто сейчас не «пишет», то она увеличивает число читателей и уменьшает число ожидающих читателей. Иначе она останавливается в ожидании разблокировки по условной переменной, освобождая мьютекс.
  
Функция 'rwlock_wrlock' блокирует на запись, она действует аналогично функции 'rwlock_rdlock', увеличивая число ожидающих писателей, проверяя, «пишет» ли сейчас кто-нибудь и есть ли читатели, затем она либо уходит в ожидание, либо уменьшает число ожидающих писателей и устанавливает внутреннюю логическую переменную в 1.
  
Функция 'rwlock_unlock' разблокирует переменную. Если значение логической переменной 1, то мы разблокируем переменную на запись, поэтому мы обнуляем логическую переменную и, если есть ожидающие писатели, будим одного из них (может писать максимум один), иначе – будим всех читателей.
  
Если же логическая переменная равна 0, то мы разблокируем переменную на чтение. Тогда мы просто уменьшаем число читателей, проверяем, есть ли ожидающие писатели, будим одного из них или будим ожидающих читателей.
